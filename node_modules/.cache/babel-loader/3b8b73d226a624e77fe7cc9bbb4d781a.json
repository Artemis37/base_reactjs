{"ast":null,"code":"import * as xlsx from 'xlsx/xlsx.mjs';\n\nconst exportExcel = (json, name, format) => {\n  const data = format ? [] : json;\n  json.forEach(item => {\n    const row = {};\n    Object.keys(format).forEach(key => {\n      row[format[key]] = item[key];\n    });\n    data.push(row);\n  });\n  const ws = xlsx.utils.json_to_sheet(data);\n  const wb = {\n    Sheets: {\n      data: ws\n    },\n    SheetNames: ['data']\n  };\n  const buffer = xlsx.write(wb, {\n    bookType: 'xlsx',\n    type: 'array'\n  });\n  const EXCEL_TYPE = 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8';\n  const EXCEL_EXTENSION = '.xlsx';\n  const blob = new Blob([buffer], {\n    type: EXCEL_TYPE\n  });\n  const link = document.createElement('a');\n  const url = window.URL.createObjectURL(blob);\n  link.href = url;\n  link.download = `${name}${EXCEL_EXTENSION}`;\n  link.click();\n};\n\nconst exportGroupExcel = (json, name, format) => {\n  const wb = {\n    Sheets: {},\n    SheetNames: []\n  };\n  Object.keys(json).forEach(key => {\n    const list = [];\n    json[key].forEach(item => {\n      const row = {};\n      Object.keys(format).forEach(keyItem => {\n        row[format[keyItem]] = item[keyItem];\n      });\n      list.push(row);\n    });\n    const ws = xlsx.utils.json_to_sheet(list);\n    wb.Sheets[key] = ws;\n    wb.SheetNames.push(key);\n  });\n  const buffer = xlsx.write(wb, {\n    bookType: 'xlsx',\n    type: 'array'\n  });\n  const EXCEL_TYPE = 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8';\n  const EXCEL_EXTENSION = '.xlsx';\n  const blob = new Blob([buffer], {\n    type: EXCEL_TYPE\n  });\n  const link = document.createElement('a');\n  const url = window.URL.createObjectURL(blob);\n  link.href = url;\n  link.download = `${name}${EXCEL_EXTENSION}`;\n  link.click();\n};\n\nexport { exportExcel, exportGroupExcel };","map":{"version":3,"names":["xlsx","exportExcel","json","name","format","data","forEach","item","row","Object","keys","key","push","ws","utils","json_to_sheet","wb","Sheets","SheetNames","buffer","write","bookType","type","EXCEL_TYPE","EXCEL_EXTENSION","blob","Blob","link","document","createElement","url","window","URL","createObjectURL","href","download","click","exportGroupExcel","list","keyItem"],"sources":["C:/Users/DELL/Downloads/ClientApp/src/utils/excel.js"],"sourcesContent":["import * as xlsx from 'xlsx/xlsx.mjs'\n\nconst exportExcel = (json, name, format) => {\n  const data = format ? [] : json\n  json.forEach((item) => {\n    const row = {}\n    Object.keys(format).forEach((key) => {\n      row[format[key]] = item[key]\n    })\n    data.push(row)\n  })\n  const ws = xlsx.utils.json_to_sheet(data)\n  const wb = { Sheets: { data: ws }, SheetNames: ['data'] }\n\n  const buffer = xlsx.write(wb, { bookType: 'xlsx', type: 'array' })\n  const EXCEL_TYPE =\n    'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8'\n  const EXCEL_EXTENSION = '.xlsx'\n  const blob = new Blob([buffer], {\n    type: EXCEL_TYPE,\n  })\n\n  const link = document.createElement('a')\n  const url = window.URL.createObjectURL(blob)\n  link.href = url\n  link.download = `${name}${EXCEL_EXTENSION}`\n  link.click()\n}\nconst exportGroupExcel = (json, name, format) => {\n  const wb = { Sheets: {}, SheetNames: [] }\n  Object.keys(json).forEach((key) => {\n    const list = []\n    json[key].forEach((item) => {\n      const row = {}\n      Object.keys(format).forEach((keyItem) => {\n        row[format[keyItem]] = item[keyItem]\n      })\n      list.push(row)\n    })\n\n    const ws = xlsx.utils.json_to_sheet(list)\n    wb.Sheets[key] = ws\n    wb.SheetNames.push(key)\n  })\n\n  const buffer = xlsx.write(wb, { bookType: 'xlsx', type: 'array' })\n  const EXCEL_TYPE =\n    'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8'\n  const EXCEL_EXTENSION = '.xlsx'\n  const blob = new Blob([buffer], {\n    type: EXCEL_TYPE,\n  })\n\n  const link = document.createElement('a')\n  const url = window.URL.createObjectURL(blob)\n  link.href = url\n  link.download = `${name}${EXCEL_EXTENSION}`\n  link.click()\n}\n\nexport { exportExcel, exportGroupExcel }\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}