{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\DELL\\\\Downloads\\\\ClientApp\\\\src\\\\components\\\\form\\\\Crud.js\",\n    _s = $RefreshSig$();\n\n/* eslint-disable max-lines-per-function */\nimport { useEffect, useState } from 'react';\nimport { Button } from 'primereact/button';\nimport { Toolbar } from 'primereact/toolbar';\nimport { useSelector } from 'react-redux';\nimport UpsertPopup from './UpsertPopup';\nimport Table from '../layout/Table';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction Crud(props) {\n  _s();\n\n  const {\n    processor,\n    moduleName,\n    column,\n    config,\n    toolbar,\n    chucNang\n  } = props;\n  let {\n    tableConfig,\n    canEdit\n  } = props;\n  tableConfig = tableConfig || {};\n  canEdit = canEdit !== false;\n  const [oneData, setOneData] = useState({});\n  const [datas, setDatas] = useState([]);\n  const [visible, setVisible] = useState(false);\n  const toast = useSelector(store => store.notify.toast);\n  const confirm = useSelector(store => store.notify.confirm);\n\n  const toggle = () => setVisible(!visible);\n\n  const getDatas = async () => {\n    const rs = await processor.getAll();\n    setDatas(rs);\n  };\n\n  const init = () => {\n    getDatas();\n  };\n\n  useEffect(init, []);\n\n  const save = async data => {\n    const rs = await processor.upsert(data);\n    let message;\n    let newData;\n\n    if (rs.isSuccess) {\n      if (data.id) {\n        newData = datas.map(item => {\n          return item.id === oneData.id ? data : item;\n        });\n        message = rs.data;\n      } else {\n        newData = [{ ...data,\n          id: rs.data\n        }, ...datas];\n        message = 'Thêm mới thành công';\n      }\n\n      setDatas(newData);\n      toggle();\n    } else {\n      message = rs.data;\n    }\n\n    toast({\n      type: rs.isSuccess ? 'success' : 'error',\n      message\n    });\n  };\n\n  const deleteOnClick = async id => {\n    const rs = await processor.delete(id);\n    toast({\n      type: rs.isSuccess ? 'success' : 'error',\n      message: rs.data\n    });\n    if (rs.isSuccess) setDatas([...datas.filter(item => item.id !== id)]);\n  };\n\n  const columnTable = [...column, {\n    name: 'Chức năng',\n    alignHeader: 'center',\n    render: data => {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex justify-content-center\",\n        children: [chucNang && chucNang(data), /*#__PURE__*/_jsxDEV(Button, {\n          icon: \"pi pi-pencil\",\n          className: \"p-button-rounded p-button-warning mr-2\",\n          visible: canEdit,\n          onClick: () => {\n            setOneData(data);\n            toggle();\n          },\n          tooltip: \"S\\u1EEDa\",\n          tooltipOptions: {\n            position: 'top'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          icon: \"pi pi-trash\",\n          className: \"p-button-rounded p-button-danger mr-2\",\n          onClick: () => {\n            confirm({\n              action: () => deleteOnClick(data.id),\n              body: `Bạn có muốn xoá ${moduleName} này?`\n            });\n          },\n          tooltip: \"Xo\\xE1\",\n          tooltipOptions: {\n            position: 'top'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 11\n      }, this);\n    }\n  }];\n  const tableHeader = `Danh sách ${moduleName}`;\n  const header = !oneData.id ? `Thêm mới ${moduleName}` : `Chỉnh sửa ${moduleName}`;\n  const configUpsert = {};\n  Object.keys(config).forEach(key => {\n    const item = config[key];\n    configUpsert[key] = typeof item === 'function' ? item(oneData) : item;\n  });\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(UpsertPopup, {\n      width: \"60%\",\n      visible: visible,\n      toggle: toggle,\n      header: header,\n      data: oneData,\n      onSave: save,\n      ...configUpsert\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card\",\n      children: [toolbar !== undefined ? toolbar : /*#__PURE__*/_jsxDEV(Toolbar, {\n        className: \"mb-4\",\n        right: /*#__PURE__*/_jsxDEV(Button, {\n          icon: \"pi pi-plus\",\n          className: \"p-button-success\",\n          label: \"Th\\xEAm\",\n          onClick: () => {\n            setOneData({});\n            toggle();\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Table, {\n        data: datas,\n        column: columnTable,\n        header: tableHeader,\n        ...tableConfig\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n\n_s(Crud, \"bYE9iJ5SxlRKpgGYTZU9YWpqzY8=\", false, function () {\n  return [useSelector, useSelector];\n});\n\n_c = Crud;\nexport default Crud;\n\nvar _c;\n\n$RefreshReg$(_c, \"Crud\");","map":{"version":3,"names":["useEffect","useState","Button","Toolbar","useSelector","UpsertPopup","Table","Crud","props","processor","moduleName","column","config","toolbar","chucNang","tableConfig","canEdit","oneData","setOneData","datas","setDatas","visible","setVisible","toast","store","notify","confirm","toggle","getDatas","rs","getAll","init","save","data","upsert","message","newData","isSuccess","id","map","item","type","deleteOnClick","delete","filter","columnTable","name","alignHeader","render","position","action","body","tableHeader","header","configUpsert","Object","keys","forEach","key","undefined"],"sources":["C:/Users/DELL/Downloads/ClientApp/src/components/form/Crud.js"],"sourcesContent":["/* eslint-disable max-lines-per-function */\nimport { useEffect, useState } from 'react'\nimport { Button } from 'primereact/button'\nimport { Toolbar } from 'primereact/toolbar'\nimport { useSelector } from 'react-redux'\nimport UpsertPopup from './UpsertPopup'\nimport Table from '../layout/Table'\n\nfunction Crud(props) {\n  const { processor, moduleName, column, config, toolbar, chucNang } = props\n  let { tableConfig, canEdit } = props\n\n  tableConfig = tableConfig || {}\n  canEdit = canEdit !== false\n\n  const [oneData, setOneData] = useState({})\n  const [datas, setDatas] = useState([])\n  const [visible, setVisible] = useState(false)\n  const toast = useSelector((store) => store.notify.toast)\n  const confirm = useSelector((store) => store.notify.confirm)\n  const toggle = () => setVisible(!visible)\n\n  const getDatas = async () => {\n    const rs = await processor.getAll()\n    setDatas(rs)\n  }\n  const init = () => {\n    getDatas()\n  }\n  useEffect(init, [])\n\n  const save = async (data) => {\n    const rs = await processor.upsert(data)\n    let message\n    let newData\n    if (rs.isSuccess) {\n      if (data.id) {\n        newData = datas.map((item) => {\n          return item.id === oneData.id ? data : item\n        })\n        message = rs.data\n      } else {\n        newData = [{ ...data, id: rs.data }, ...datas]\n        message = 'Thêm mới thành công'\n      }\n      setDatas(newData)\n      toggle()\n    } else {\n      message = rs.data\n    }\n    toast({ type: rs.isSuccess ? 'success' : 'error', message })\n  }\n  const deleteOnClick = async (id) => {\n    const rs = await processor.delete(id)\n    toast({ type: rs.isSuccess ? 'success' : 'error', message: rs.data })\n    if (rs.isSuccess) setDatas([...datas.filter((item) => item.id !== id)])\n  }\n\n  const columnTable = [\n    ...column,\n    {\n      name: 'Chức năng',\n      alignHeader: 'center',\n      render: (data) => {\n        return (\n          <div className=\"flex justify-content-center\">\n            {chucNang && chucNang(data)}\n            <Button\n              icon=\"pi pi-pencil\"\n              className=\"p-button-rounded p-button-warning mr-2\"\n              visible={canEdit}\n              onClick={() => {\n                setOneData(data)\n                toggle()\n              }}\n              tooltip=\"Sửa\"\n              tooltipOptions={{ position: 'top' }}\n            />\n            <Button\n              icon=\"pi pi-trash\"\n              className=\"p-button-rounded p-button-danger mr-2\"\n              onClick={() => {\n                confirm({\n                  action: () => deleteOnClick(data.id),\n                  body: `Bạn có muốn xoá ${moduleName} này?`,\n                })\n              }}\n              tooltip=\"Xoá\"\n              tooltipOptions={{ position: 'top' }}\n            />\n          </div>\n        )\n      },\n    },\n  ]\n\n  const tableHeader = `Danh sách ${moduleName}`\n  const header = !oneData.id ? `Thêm mới ${moduleName}` : `Chỉnh sửa ${moduleName}`\n\n  const configUpsert = {}\n  Object.keys(config).forEach((key) => {\n    const item = config[key]\n    configUpsert[key] = typeof item === 'function' ? item(oneData) : item\n  })\n  return (\n    <>\n      <UpsertPopup\n        width=\"60%\"\n        visible={visible}\n        toggle={toggle}\n        header={header}\n        data={oneData}\n        onSave={save}\n        {...configUpsert}\n      />\n      <div className=\"card\">\n        {toolbar !== undefined ? (\n          toolbar\n        ) : (\n          <Toolbar\n            className=\"mb-4\"\n            right={\n              <Button\n                icon=\"pi pi-plus\"\n                className=\"p-button-success\"\n                label=\"Thêm\"\n                onClick={() => {\n                  setOneData({})\n                  toggle()\n                }}\n              />\n            }\n          />\n        )}\n        <Table data={datas} column={columnTable} header={tableHeader} {...tableConfig} />\n      </div>\n    </>\n  )\n}\n\nexport default Crud\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}