{"ast":null,"code":"import history from '../history';\nimport { getToken, removeToken } from '../utils/security';\n\nconst request = async _ref => {\n  let {\n    url,\n    method = 'get',\n    auth = false,\n    data = null,\n    formData = null,\n    callback = null,\n    responseType = 'json'\n  } = _ref;\n  let response;\n  const headers = formData ? new Headers() : {\n    'Content-Type': 'application/json; charset=UTF-8'\n  };\n  let paramsObj = '';\n\n  if (auth) {\n    const token = getToken();\n\n    if (formData) {\n      headers.append('Authorization', `Bearer ${token}`);\n    } else {\n      headers.Authorization = `Bearer ${token}`;\n    }\n  }\n\n  if (data) {\n    paramsObj = formData ? data : JSON.stringify(data);\n  }\n\n  const requestOptions = {\n    method,\n    headers\n  };\n\n  if (method !== 'get') {\n    requestOptions.body = paramsObj;\n  }\n\n  await fetch(url, requestOptions).then(async rs => {\n    if (rs.status === 200) {\n      return rs[responseType]();\n    }\n\n    if (rs.status === 401) {\n      removeToken();\n\n      if (history.location.pathname) {\n        history.push('/login', [history.location.pathname]);\n      } else history.replace();\n    }\n\n    const text = await rs.text();\n    throw text || 'Đã có lỗi xảy ra';\n  }).then(rs => {\n    if (callback) callback(rs);\n    response = {\n      isSuccess: true,\n      data: rs\n    };\n  }).catch(ex => {\n    response = {\n      isSuccess: false,\n      data: ex\n    };\n  });\n  return response;\n};\n\nexport default request;","map":{"version":3,"names":["history","getToken","removeToken","request","url","method","auth","data","formData","callback","responseType","response","headers","Headers","paramsObj","token","append","Authorization","JSON","stringify","requestOptions","body","fetch","then","rs","status","location","pathname","push","replace","text","isSuccess","catch","ex"],"sources":["C:/Users/DELL/Downloads/ClientApp/src/apis/request.js"],"sourcesContent":["import history from '../history'\nimport { getToken, removeToken } from '../utils/security'\n\nconst request = async ({\n  url,\n  method = 'get',\n  auth = false,\n  data = null,\n  formData = null,\n  callback = null,\n  responseType = 'json',\n}) => {\n  let response\n  const headers = formData\n    ? new Headers()\n    : {\n        'Content-Type': 'application/json; charset=UTF-8',\n      }\n  let paramsObj = ''\n  if (auth) {\n    const token = getToken()\n    if (formData) {\n      headers.append('Authorization', `Bearer ${token}`)\n    } else {\n      headers.Authorization = `Bearer ${token}`\n    }\n  }\n  if (data) {\n    paramsObj = formData ? data : JSON.stringify(data)\n  }\n  const requestOptions = { method, headers }\n  if (method !== 'get') {\n    requestOptions.body = paramsObj\n  }\n  await fetch(url, requestOptions)\n    .then(async (rs) => {\n      if (rs.status === 200) {\n        return rs[responseType]()\n      }\n      if (rs.status === 401) {\n        removeToken()\n        if (history.location.pathname) {\n          history.push('/login', [history.location.pathname])\n        } else history.replace()\n      }\n      const text = await rs.text()\n      throw text || 'Đã có lỗi xảy ra'\n    })\n    .then((rs) => {\n      if (callback) callback(rs)\n      response = { isSuccess: true, data: rs }\n    })\n    .catch((ex) => {\n      response = { isSuccess: false, data: ex }\n    })\n  return response\n}\n\nexport default request\n"],"mappings":"AAAA,OAAOA,OAAP,MAAoB,YAApB;AACA,SAASC,QAAT,EAAmBC,WAAnB,QAAsC,mBAAtC;;AAEA,MAAMC,OAAO,GAAG,cAQV;EAAA,IARiB;IACrBC,GADqB;IAErBC,MAAM,GAAG,KAFY;IAGrBC,IAAI,GAAG,KAHc;IAIrBC,IAAI,GAAG,IAJc;IAKrBC,QAAQ,GAAG,IALU;IAMrBC,QAAQ,GAAG,IANU;IAOrBC,YAAY,GAAG;EAPM,CAQjB;EACJ,IAAIC,QAAJ;EACA,MAAMC,OAAO,GAAGJ,QAAQ,GACpB,IAAIK,OAAJ,EADoB,GAEpB;IACE,gBAAgB;EADlB,CAFJ;EAKA,IAAIC,SAAS,GAAG,EAAhB;;EACA,IAAIR,IAAJ,EAAU;IACR,MAAMS,KAAK,GAAGd,QAAQ,EAAtB;;IACA,IAAIO,QAAJ,EAAc;MACZI,OAAO,CAACI,MAAR,CAAe,eAAf,EAAiC,UAASD,KAAM,EAAhD;IACD,CAFD,MAEO;MACLH,OAAO,CAACK,aAAR,GAAyB,UAASF,KAAM,EAAxC;IACD;EACF;;EACD,IAAIR,IAAJ,EAAU;IACRO,SAAS,GAAGN,QAAQ,GAAGD,IAAH,GAAUW,IAAI,CAACC,SAAL,CAAeZ,IAAf,CAA9B;EACD;;EACD,MAAMa,cAAc,GAAG;IAAEf,MAAF;IAAUO;EAAV,CAAvB;;EACA,IAAIP,MAAM,KAAK,KAAf,EAAsB;IACpBe,cAAc,CAACC,IAAf,GAAsBP,SAAtB;EACD;;EACD,MAAMQ,KAAK,CAAClB,GAAD,EAAMgB,cAAN,CAAL,CACHG,IADG,CACE,MAAOC,EAAP,IAAc;IAClB,IAAIA,EAAE,CAACC,MAAH,KAAc,GAAlB,EAAuB;MACrB,OAAOD,EAAE,CAACd,YAAD,CAAF,EAAP;IACD;;IACD,IAAIc,EAAE,CAACC,MAAH,KAAc,GAAlB,EAAuB;MACrBvB,WAAW;;MACX,IAAIF,OAAO,CAAC0B,QAAR,CAAiBC,QAArB,EAA+B;QAC7B3B,OAAO,CAAC4B,IAAR,CAAa,QAAb,EAAuB,CAAC5B,OAAO,CAAC0B,QAAR,CAAiBC,QAAlB,CAAvB;MACD,CAFD,MAEO3B,OAAO,CAAC6B,OAAR;IACR;;IACD,MAAMC,IAAI,GAAG,MAAMN,EAAE,CAACM,IAAH,EAAnB;IACA,MAAMA,IAAI,IAAI,kBAAd;EACD,CAbG,EAcHP,IAdG,CAcGC,EAAD,IAAQ;IACZ,IAAIf,QAAJ,EAAcA,QAAQ,CAACe,EAAD,CAAR;IACdb,QAAQ,GAAG;MAAEoB,SAAS,EAAE,IAAb;MAAmBxB,IAAI,EAAEiB;IAAzB,CAAX;EACD,CAjBG,EAkBHQ,KAlBG,CAkBIC,EAAD,IAAQ;IACbtB,QAAQ,GAAG;MAAEoB,SAAS,EAAE,KAAb;MAAoBxB,IAAI,EAAE0B;IAA1B,CAAX;EACD,CApBG,CAAN;EAqBA,OAAOtB,QAAP;AACD,CArDD;;AAuDA,eAAeR,OAAf"},"metadata":{},"sourceType":"module"}