{"ast":null,"code":"import history from '../history';\nimport { getToken, removeToken } from '../utils/security';\nconst request = async ({\n  url,\n  method = 'get',\n  auth = false,\n  data = null,\n  formData = null,\n  callback = null,\n  responseType = 'json'\n}) => {\n  let response;\n  const headers = formData ? new Headers() : {\n    'Content-Type': 'application/json; charset=UTF-8'\n  };\n  let paramsObj = '';\n  if (auth) {\n    const token = getToken();\n    if (formData) {\n      headers.append('Authorization', `Bearer ${token}`);\n    } else {\n      headers.Authorization = `Bearer ${token}`;\n    }\n  }\n  if (data) {\n    paramsObj = formData ? data : JSON.stringify(data);\n  }\n  const requestOptions = {\n    method,\n    headers\n  };\n  if (method !== 'get') {\n    requestOptions.body = paramsObj;\n  }\n  await fetch(url, requestOptions).then(async rs => {\n    if (rs.status === 200) {\n      return rs[responseType]();\n    }\n    if (rs.status === 401) {\n      removeToken();\n      if (history.location.pathname) {\n        history.push('/login', [history.location.pathname]);\n      } else history.replace();\n    }\n    const text = await rs.text();\n    throw text || 'Đã có lỗi xảy ra';\n  }).then(rs => {\n    if (callback) callback(rs);\n    response = {\n      isSuccess: true,\n      data: rs\n    };\n  }).catch(ex => {\n    response = {\n      isSuccess: false,\n      data: ex\n    };\n  });\n  return response;\n};\nexport default request;","map":{"version":3,"names":["history","getToken","removeToken","request","url","method","auth","data","formData","callback","responseType","response","headers","Headers","paramsObj","token","append","Authorization","JSON","stringify","requestOptions","body","fetch","then","rs","status","location","pathname","push","replace","text","isSuccess","catch","ex"],"sources":["C:/Users/NoMin/OneDrive/Desktop/base_reactjs/src/apis/request.js"],"sourcesContent":["import history from '../history'\r\nimport { getToken, removeToken } from '../utils/security'\r\n\r\nconst request = async ({\r\n  url,\r\n  method = 'get',\r\n  auth = false,\r\n  data = null,\r\n  formData = null,\r\n  callback = null,\r\n  responseType = 'json',\r\n}) => {\r\n  let response\r\n  const headers = formData\r\n    ? new Headers()\r\n    : {\r\n        'Content-Type': 'application/json; charset=UTF-8',\r\n      }\r\n  let paramsObj = ''\r\n  if (auth) {\r\n    const token = getToken()\r\n    if (formData) {\r\n      headers.append('Authorization', `Bearer ${token}`)\r\n    } else {\r\n      headers.Authorization = `Bearer ${token}`\r\n    }\r\n  }\r\n  if (data) {\r\n    paramsObj = formData ? data : JSON.stringify(data)\r\n  }\r\n  const requestOptions = { method, headers }\r\n  if (method !== 'get') {\r\n    requestOptions.body = paramsObj\r\n  }\r\n  await fetch(url, requestOptions)\r\n    .then(async (rs) => {\r\n      if (rs.status === 200) {\r\n        return rs[responseType]()\r\n      }\r\n      if (rs.status === 401) {\r\n        removeToken()\r\n        if (history.location.pathname) {\r\n          history.push('/login', [history.location.pathname])\r\n        } else history.replace()\r\n      }\r\n      const text = await rs.text()\r\n      throw text || 'Đã có lỗi xảy ra'\r\n    })\r\n    .then((rs) => {\r\n      if (callback) callback(rs)\r\n      response = { isSuccess: true, data: rs }\r\n    })\r\n    .catch((ex) => {\r\n      response = { isSuccess: false, data: ex }\r\n    })\r\n  return response\r\n}\r\n\r\nexport default request\r\n"],"mappings":"AAAA,OAAOA,OAAO,MAAM,YAAY;AAChC,SAASC,QAAQ,EAAEC,WAAW,QAAQ,mBAAmB;AAEzD,MAAMC,OAAO,GAAG,MAAAA,CAAO;EACrBC,GAAG;EACHC,MAAM,GAAG,KAAK;EACdC,IAAI,GAAG,KAAK;EACZC,IAAI,GAAG,IAAI;EACXC,QAAQ,GAAG,IAAI;EACfC,QAAQ,GAAG,IAAI;EACfC,YAAY,GAAG;AACjB,CAAC,KAAK;EACJ,IAAIC,QAAQ;EACZ,MAAMC,OAAO,GAAGJ,QAAQ,GACpB,IAAIK,OAAO,CAAC,CAAC,GACb;IACE,cAAc,EAAE;EAClB,CAAC;EACL,IAAIC,SAAS,GAAG,EAAE;EAClB,IAAIR,IAAI,EAAE;IACR,MAAMS,KAAK,GAAGd,QAAQ,CAAC,CAAC;IACxB,IAAIO,QAAQ,EAAE;MACZI,OAAO,CAACI,MAAM,CAAC,eAAe,EAAG,UAASD,KAAM,EAAC,CAAC;IACpD,CAAC,MAAM;MACLH,OAAO,CAACK,aAAa,GAAI,UAASF,KAAM,EAAC;IAC3C;EACF;EACA,IAAIR,IAAI,EAAE;IACRO,SAAS,GAAGN,QAAQ,GAAGD,IAAI,GAAGW,IAAI,CAACC,SAAS,CAACZ,IAAI,CAAC;EACpD;EACA,MAAMa,cAAc,GAAG;IAAEf,MAAM;IAAEO;EAAQ,CAAC;EAC1C,IAAIP,MAAM,KAAK,KAAK,EAAE;IACpBe,cAAc,CAACC,IAAI,GAAGP,SAAS;EACjC;EACA,MAAMQ,KAAK,CAAClB,GAAG,EAAEgB,cAAc,CAAC,CAC7BG,IAAI,CAAC,MAAOC,EAAE,IAAK;IAClB,IAAIA,EAAE,CAACC,MAAM,KAAK,GAAG,EAAE;MACrB,OAAOD,EAAE,CAACd,YAAY,CAAC,CAAC,CAAC;IAC3B;IACA,IAAIc,EAAE,CAACC,MAAM,KAAK,GAAG,EAAE;MACrBvB,WAAW,CAAC,CAAC;MACb,IAAIF,OAAO,CAAC0B,QAAQ,CAACC,QAAQ,EAAE;QAC7B3B,OAAO,CAAC4B,IAAI,CAAC,QAAQ,EAAE,CAAC5B,OAAO,CAAC0B,QAAQ,CAACC,QAAQ,CAAC,CAAC;MACrD,CAAC,MAAM3B,OAAO,CAAC6B,OAAO,CAAC,CAAC;IAC1B;IACA,MAAMC,IAAI,GAAG,MAAMN,EAAE,CAACM,IAAI,CAAC,CAAC;IAC5B,MAAMA,IAAI,IAAI,kBAAkB;EAClC,CAAC,CAAC,CACDP,IAAI,CAAEC,EAAE,IAAK;IACZ,IAAIf,QAAQ,EAAEA,QAAQ,CAACe,EAAE,CAAC;IAC1Bb,QAAQ,GAAG;MAAEoB,SAAS,EAAE,IAAI;MAAExB,IAAI,EAAEiB;IAAG,CAAC;EAC1C,CAAC,CAAC,CACDQ,KAAK,CAAEC,EAAE,IAAK;IACbtB,QAAQ,GAAG;MAAEoB,SAAS,EAAE,KAAK;MAAExB,IAAI,EAAE0B;IAAG,CAAC;EAC3C,CAAC,CAAC;EACJ,OAAOtB,QAAQ;AACjB,CAAC;AAED,eAAeR,OAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}